generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String             @id @default(cuid())
  name            String?            @db.VarChar(100)
  date_of_birth   DateTime?
  email           String             @unique @db.VarChar(255)
  provider        AuthProvider       @default(EMAIL)
  providerId      String?            @db.VarChar(100)
  email_verified  Boolean            @default(false)

  notes                 Note[]
  verification_tokens   VerificationToken[]

  @@map("users")
}

model VerificationToken {
  id         String      @id @default(cuid())
  user_id    String
  code       String      @db.VarChar(6)
  type       VerificationType
  created_at DateTime    @default(now())
  expires_at DateTime
  
  user       User        @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("verification-codes")
}

model Note {
  id         String   @id @default(cuid())
  title      String   @db.VarChar(255)
  content    String?  @db.Text
  user_id    String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user User  @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id])
  @@map("notes")
}

enum AuthProvider {
  EMAIL
  GOOGLE
}

enum VerificationType {
  SIGNIN
  EMAIL_CONFIRM
}
